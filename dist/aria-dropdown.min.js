!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery,window)}(function(e,t){"use strict";var n="ariaDropdown",s="aria-controls",a="aria-hidden",i="aria-owns",o="aria-expanded",d="aria-haspopup",l="z-index",r="true",u="false",p="data-ariadropdown-collapselabel",m="data-ariadropdown-expandlabel",c=0,g=e(t);function f(e,t,n){return e.is("[id]")||e.attr("id",t+n),e.attr("id")}function C(e,t){for(;"BODY"!==e[0].tagName&&void 0===e.data(t);)e=e.parent();for(var n=e.find("*"),s=n.length,a=[],i=0;i<s;i++){var o=n.eq(i);void 0!==o.data(t)&&a.push(o)}return a}function v(t,s){var a=this;a.settings=e.extend({},e.fn[n].defaultSettings,s),a.element=e(t),a.btn=a.element.find("> ."+a.settings.btnClass).first(),a.menu=a.element.find("> ."+a.settings.menuClass).first(),a.elementStatus=!1,a.mouse=!1,a.init()}e.extend(v.prototype,{init:function(){var t,o=this,l=o.settings,u=o.menu,v=o.btn,x=o.element,h=l.dynamicBtnLabel,b=0;g.on("touchstart."+n,function(e){e.preventDefault(),t=e.timeStamp}),g.on("touchmove."+n,function(e){e.preventDefault(),b=e.timeStamp}),g.on("touchend."+n,function(s){var a,i;s.preventDefault(),a=t,i=s.timeStamp,b<a&&(console.log("tap"),i-a<300)&&e(s.target).trigger("simulatedClick."+n)}),g.on("click."+n,function(t){e(t.target).trigger("simulatedClick."+n)}),o.btnId=f(o.btn,"dropdown__btn--",c),o.menuId=f(o.menu,"dropdown__menu--",c),u.attr(a,r).attr(i,o.btnId),v.attr(d,r).attr(s,o.menuId),o.slideUp(!1),o.settings.collapseOnOutsideClick?g.on("simulatedClick."+n,function(){o.elementStatus&&o.slideUp(!0)}):g.on("simulatedClick."+n,function(){var e=function(e,t){for(var n=[];"BODY"!==e[0].tagName;)(e=e.parent()).data(t)&&n.push(e);return n}(o.element,"plugin_"+n),t=e.length,s=0,a=!1;if(t>0){for(;s<t&&!a;)e[s].data("plugin_"+n).settings.collapseOnOutsideClick&&(a=!0),s++;a&&o.slideUp(!0)}}),x.on("simulatedClick."+n,function(t){o.mouse||o.toggle(!0),t.stopPropagation();for(var s=C(e(t.target),"plugin_"+n),a=s.length,i={},d=0;d<a;d++)(i=s[d].data("plugin_"+n)).elementStatus&&i.slideUp(!0)}),l.collapseOnMenuClick||u.on("simulatedClick."+n,function(e){e.stopPropagation()}),l.expandOnlyOne&&g.on(n+".slideDown",function(e,t){for(var s=C(x,"plugin_"+n),a=s.length,i=!1,d=0;!i&&d<a;)t===s[d].data("plugin_"+n)&&(i=!0),d++;t!==x&&!i&&o.elementStatus&&o.slideUp(!0)}),l.mouse&&(x.on("touchend."+n,function(e){o.mouse=!1}),x.on("mouseenter."+n,function(){o.mouse=!0,o.elementStatus||o.slideDown(!0)}),x.on("mouseleave."+n,function(){o.mouse=!1,o.elementStatus&&o.slideUp(!0)})),h&&(o.dynamicBtnEl="string"==typeof h?v.find(h):v,o.collapseLabel=v.attr(p),o.expandLabel=v.attr(m)),g.trigger(n+".initialised",[o]),c+=1},toggle:function(){this.elementStatus?this.slideUp(!0):this.slideDown(!0)},collapse:function(){var e=this,t=e.settings;e.element.removeClass(t.dropdownExpandedClass),e.btn.removeClass(t.btnExpandedClass).attr(o,u),e.menu.removeClass(t.menuExpandedClass).attr(a,r),e.dynamicBtnEl&&e.dynamicBtnEl.text(e.expandLabel),e.elementStatus=!1},expand:function(){var e=this,t=e.settings;e.element.addClass(t.dropdownExpandedClass),e.btn.addClass(t.btnExpandedClass).attr(o,r),e.menu.addClass(t.menuExpandedClass).attr(a,u),e.dynamicBtnEl&&e.dynamicBtnEl.text(e.collapseLabel),e.elementStatus=!0},slideDown:function(e){var t=this,s=e?t.settings.slideSpeed:0;t.settings.cssTransitions||(t.element.css(l,t.settings.expandZIndex),t.menu.stop().slideDown(s,t.settings.easing)),g.trigger(n+".slideDown",[t]),t.expand()},slideUp:function(e){var t=this,s=e?t.settings.slideSpeed:0;t.settings.cssTransitions||(t.element.css(l,t.settings.collapseZIndex),t.menu.stop().slideUp(s,t.settings.easing)),g.trigger(n+".slideUp",[t]),t.collapse()},destroy:function(){var e=this,t=e.settings;e.btn.removeAttr(d).removeAttr(s).removeAttr(o).removeClass(t.btnExpandedClass),e.menu.removeAttr(i).removeAttr(a).removeClass(t.menuExpandedClass).off("click."+n),e.element.removeClass(t.dropdownExpandedClass).off("click."+n+" mouseenter."+n+" mouseleave."+n).removeData("plugin_"+n),g.trigger(n+".destroyed",[e])},methodCaller:function(e){var t=this;switch(e){case"toggle":t.toggle(!0);break;case"slideDown":t.elementStatus||t.slideDown(!0);break;case"slideUp":t.elementStatus&&t.slideUp(!0);break;case"destroy":t.destroy()}}}),e.fn[n]=function(t){return this.each(function(){e.data(this,"plugin_"+n)||"object"!=typeof t&&void 0!==t?"string"==typeof t&&e.data(this,"plugin_"+n).methodCaller(t):e.data(this,"plugin_"+n,new v(this,t))})},e.fn[n].defaultSettings={btnClass:"dropdown__btn",menuClass:"dropdown__menu",dropdownExpandedClass:"dropdown_expanded",btnExpandedClass:"dropdown__btn_expanded",menuExpandedClass:"dropdown__menu_expanded",slideSpeed:300,easing:"swing",collapseOnOutsideClick:!0,collapseOnMenuClick:!1,expandOnlyOne:!0,expandZIndex:10,collapseZIndex:1,cssTransitions:!1,mouse:!1,dynamicBtnLabel:!1}});